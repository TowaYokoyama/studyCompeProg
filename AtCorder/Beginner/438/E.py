"""
AtCorder.Beginner.438.E の Docstring
問題文
N 人の人がおり、N 個のバケツがあります。人とバケツにはそれぞれ 1,2,…,N の番号が付けられています。

人 i ははじめバケツ i のみを持っており、バケツ i には何も入っていません。

これから、以下の操作を 10 
9
  回行います。

i=1,2,…,N について同時に、人 i が持っているバケツすべてに水を i ずつ入れ、それらのバケツを人 A 
i
​	
  に渡す。
ただし、バケツに入れることのできる水の量に制限はありません。

i=1,2,…,Q について以下の形式のクエリに答えてください。

T 
i
​	
  回目の操作の直後にバケツ B 
i
​	
  に入っている水の量を求めてください。
制約
2≤N≤2×10 
5
 
1≤Q≤2×10 
5
 
1≤A 
i
​	
 ≤N
1≤T 
i
​	
 ≤10 
9
 
1≤B 
i
​	
 ≤N
入力される値はすべて整数
入力
入力は以下の形式で標準入力から与えられる。

N Q
A 
1
​	
  A 
2
​	
  … A 
N
​	
 
T 
1
​	
  B 
1
​	
 
T 
2
​	
  B 
2
​	
 
⋮
T 
Q
​	
  B 
Q
​	
 
出力
Q 行出力せよ。i 行目には i 番目のクエリに対する答えを出力せよ。

入力例 1
Copy
5 6
3 4 2 2 5
4 3
6 5
1 4
10 1
10 2
1000000000 1
出力例 1
Copy
11
30
4
28
30
2999999998
1 番目のクエリに対する説明を行います。

はじめ、バケツ 3 は人 3 が持っています。

1 回目の操作の直後、バケツ 3 は人 2 が持っており、水が 3 入っています。

2 回目の操作の直後、バケツ 3 は人 4 が持っており、水が 5 入っています。

3 回目の操作の直後、バケツ 3 は人 2 が持っており、水が 9 入っています。

4 回目の操作の直後、バケツ 3 は人 4 が持っており、水が 11 入っています。

したがって、1 番目のクエリに対する答えは 11 となります。

"""
# =========================
# 入力
# =========================
N, Q = map(int, input().split())

A = list(map(int, input().split()))
for i in range(N):
    A[i] -= 1   # 0-index にする

queries = []
for _ in range(Q):
    T, B = map(int, input().split())
    queries.append((T, B))

# =========================
# ダブリング準備
# =========================
LOG = 60  # 2^60 > 10^9

# next[k][i]: 人 i から 2^k 回後にいる人
next_ = []
for _ in range(LOG):
    next_.append([0] * N)

# sum_[k][i]: その 2^k 回で増える水の量
sum_ = []
for _ in range(LOG):
    sum_.append([0] * N)

# --- 1回後 ---
for i in range(N):
    next_[0][i] = A[i]
    sum_[0][i] = i + 1   # 人番号は 1-index

# --- 2^k 回後 ---
for k in range(LOG - 1):
    for i in range(N):
        mid = next_[k][i]
        next_[k + 1][i] = next_[k][mid]
        sum_[k + 1][i] = sum_[k][i] + sum_[k][mid]

# =========================
# クエリ処理
# =========================
for T, B in queries:
    cur = B - 1
    ans = 0
    bit = 0

    while T > 0:
        if T % 2 == 1:
            ans += sum_[bit][cur]
            cur = next_[bit][cur]
        T //= 2
        bit += 1

    print(ans)
